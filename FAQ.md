# Часто задаваемые вопросы (FAQ)

## Общие вопросы

### Q: Что лучше - Supabase или Firebase?

**A**: 
- **Supabase**: Open-source, полная база PostgreSQL, работает на вашем сервере, дешевле при масштабировании
- **Firebase**: Управляемый сервис Google, быстрый старт, но более дорогой при масштабировании и меньше контроля

Для самостоятельного размещения выбирайте Supabase.

### Q: Что такое n8n и зачем это нужно?

**A**: n8n - это инструмент для автоматизации бизнес-процессов без кода:
- Соединяет различные приложения (более 400 интеграций)
- Автоматизирует повторяющиеся задачи
- Экономит время разработчиков и бизнеса
- Пример: при новом заказе в Supabase автоматически отправить email и обновить Google Sheets

### Q: Могу ли я использовать Supabase и n8n отдельно?

**A**: Да, они полностью независимы:
- Supabase = база данных + API
- n8n = автоматизация процессов

Но вместе они дают максимальную мощь. Интеграция опциональна.

## Развертывание и установка

### Q: Какие минимальные требования к серверу?

**A**: 
- CPU: 2+ ядра
- RAM: 4+ GB
- Диск: 20+ GB SSD
- ОС: Ubuntu 20.04+, Debian 11+

Для production используйте 4+ ядра и 16+ GB RAM.

### Q: Сколько стоит?

**A**: 
- Программное обеспечение: БЕСПЛАТНО (open-source)
- Сервер: от $5-50/месяц в зависимости от провайдера
- Итого: примерно столько же, сколько стоит один сотрудник в час

### Q: Что означают переменные в .env файле?

**A**: Основные переменные:

```bash
SUPABASE_DB_PASSWORD       # Пароль базы данных
N8N_ENCRYPTION_KEY         # Ключ шифрования n8n
WEBHOOK_URL                # Адрес webhook n8n
```

Используйте `.env.example` как шаблон.

### Q: Как безопасно хранить пароли?

**A**: 
1. ✅ Используйте `.env` файлы с сильными паролями
2. ✅ Добавьте `.env` в `.gitignore` (не коммитьте!)
3. ✅ Используйте разные пароли для разных окружений
4. ❌ Никогда не пишите пароли в коде
5. ❌ Не отправляйте пароли по email

## Использование Supabase

### Q: Как создать таблицу в Supabase?

**A**: Два способа:

1. **Через UI (рекомендуется для начинающих)**:
   - Откройте Supabase Studio
   - Database → Tables → Create table

2. **Через SQL**:
   ```sql
   CREATE TABLE users (
     id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
     email TEXT UNIQUE NOT NULL,
     name TEXT,
     created_at TIMESTAMP DEFAULT NOW()
   );
   ```

### Q: Что такое RLS (Row Level Security)?

**A**: Система прав доступа к строкам:
- Каждая строка может иметь разные правила доступа
-例: пользователь может видеть только свои данные
- Пример:
  ```sql
  ALTER TABLE users ENABLE ROW LEVEL SECURITY;
  CREATE POLICY "Users see own data" 
  ON users FOR SELECT USING (auth.uid() = id);
  ```

### Q: Как импортировать данные в Supabase?

**A**: 
1. Через CSV файл (Database → Tables → Import data)
2. Через API (HTTP POST запрос)
3. Через SQL INSERT
4. Через n8n workflow

### Q: Как экспортировать данные из Supabase?

**A**: 
1. Через PostgreSQL dump: `pg_dump -U postgres -h host database > backup.sql`
2. Через REST API: GET запрос к таблице
3. Через n8n: Export workflow
4. Через Supabase UI: таблица → Export

### Q: Как использовать функции PostgreSQL?

**A**: Функции используются для сложной логики:
```sql
CREATE OR REPLACE FUNCTION get_user_by_email(email TEXT)
RETURNS SETOF users AS $$
BEGIN
  RETURN QUERY SELECT * FROM users WHERE email = $1;
END;
$$ LANGUAGE plpgsql;

-- Вызов функции
SELECT get_user_by_email('user@example.com');
```

## Использование n8n

### Q: Как создать первый workflow?

**A**: 
1. Откройте n8n (http://localhost:5678)
2. Create New Workflow
3. Добавьте Manual trigger (для тестирования)
4. Добавьте любую ноду (например, Set для установки переменных)
5. Нажмите "Execute Workflow"

### Q: Что такое webhook и зачем он нужен?

**A**: Webhook - это HTTP endpoint для запуска workflow:
- Supabase может отправлять события в n8n при изменении данных
- n8n создает URL для приема этих событий
- Пример: при INSERT в таблицу → отправить email

### Q: Как связать n8n с Supabase?

**A**: 
1. Создайте Credential в n8n для Supabase
2. Используйте HTTP Request ноду для вызова Supabase API
3. Или используйте PostgreSQL ноду для прямого подключения
4. Подробнее: [supabase-n8n-integration.md](./docs/supabase-n8n-integration.md)

### Q: Как обработать ошибки в workflow?

**A**: 
1. Используйте Try-Catch ноду
2. Добавьте логирование в Code ноде
3. Используйте Error Handling в ноде Settings
4. Отправляйте алерты при критических ошибках

### Q: Как запустить workflow по расписанию?

**A**: 
1. Используйте Cron ноду вместо Manual trigger
2. Пример CRON: `0 9 * * *` = каждый день в 9:00
3. Или используйте Schedule ноду

### Q: Как экспортировать/импортировать workflow?

**A**: 
1. Экспорт: Settings → Download (сохранит JSON)
2. Импорт: Home → Import from file → выберите JSON
3. Используйте Git для версионирования

## Интеграция и автоматизация

### Q: Как связать n8n с Google Sheets?

**A**: 
1. Add Google Sheets ноду
2. Авторизуйтесь через OAuth
3. Выберите Spreadsheet и Sheet
4. Используйте операции: Add rows, Clear, Read и т.д.

### Q: Как отправить email из n8n?

**A**: 
1. Add Email ноду
2. Настройте SMTP (или используйте Gmail)
3. Заполните: To, Subject, Body (HTML или Text)
4. Используйте переменные: `{{ $json.email }}`

### Q: Как отправить сообщение в Slack из n8n?

**A**: 
1. Create Incoming Webhook в Slack
2. Add Slack ноду в n8n
3. Выберите операцию: Post Message
4. Заполните текст сообщения
5. Отправьте!

### Q: Как синхронизировать данные между системами?

**A**: 
Используйте n8n workflow:
1. GET данные из Source (Supabase, API, Google Sheets)
2. Transform данные если нужно
3. POST/UPDATE в Target
4. Используйте Batch processing для больших объемов
5. Добавьте Schedule для регулярной синхронизации

### Q: Как создать webhook из другой системы в n8n?

**A**: 
1. В n8n добавьте Webhook ноду
2. Копируйте сгенерированный URL
3. В другой системе (Supabase, Zapier, etc) добавьте webhook
4. URL: сгенерированный URL из n8n
5. Метод: POST
6. Body: отправьте JSON данные

## Производительность и оптимизация

### Q: Workflow работает слишком медленно, что делать?

**A**: 
1. Используйте Batch processing (Loop с batch size > 1)
2. Добавьте индексы в БД на часто используемые столбцы
3. Ограничьте количество данных (LIMIT в SQL)
4. Используйте кеширование если возможно
5. Распределите обработку на несколько n8n workers

### Q: Как оптимизировать SQL запросы?

**A**: 
1. Используйте EXPLAIN ANALYZE для анализа
2. Создавайте индексы на часто фильтруемые столбцы
3. Используйте LIMIT для ограничения результатов
4. Избегайте LIKE '%value%' (используйте индексы)
5. Используйте JOINs вместо loop с запросами

### Q: Сколько пользователей/данных может выдержать?

**A**: 
- С 1 сервером: 100k-1M пользователей
- С оптимизацией БД: 10M+ записей
- Масштабируйте горизонтально (несколько серверов) при необходимости
- Используйте кеширование (Redis) для популярных данных

## Безопасность

### Q: Как защитить свои данные?

**A**: 
1. ✅ Используйте RLS в Supabase
2. ✅ Включите HTTPS/SSL
3. ✅ Используйте сильные пароли
4. ✅ Регулярно обновляйте ПО
5. ✅ Делайте резервные копии
6. ✅ Мониторьте логи на подозрительную активность
7. ✅ Используйте 2FA где возможно

### Q: Что делать если я забыл пароль?

**A**: 
1. **Supabase**: использовать reset password через email
2. **n8n**: перезагрузить контейнер и воссоздать учетную запись
3. **PostgreSQL**: подключиться как postgres user и изменить пароль

### Q: Как я узнаю если произошла утечка данных?

**A**: 
1. Проверяйте логи регулярно: `docker-compose logs`
2. Используйте мониторинг (скрипт `/opt/monitor.sh`)
3. Настройте алерты при необычной активности
4. Используйте WAF (Web Application Firewall)

## Резервное копирование и восстановление

### Q: Как часто делать резервные копии?

**A**: 
- **Critical data**: ежедневно (рекомендуется)
- **Development**: еженедельно
- **Compliance**: в зависимости от требований
- **Production**: как минимум 2 копии в разных местах

### Q: Что делать если диск переполнен?

**A**: 
1. Проверьте размер БД: `du -sh /opt/supabase/docker/volumes/db`
2. Удалите старые резервные копии: `rm -f /backups/*_*.dump`
3. Очистите логи: `truncate -s 0 /var/log/n8n/*.log`
4. Удалите старые execution данные из n8n
5. Увеличьте объем диска (если используется VPS)

### Q: Как восстановить из резервной копии?

**A**: 
```bash
# Остановить сервис
docker-compose down

# Восстановить БД
docker-compose up -d postgres
pg_restore -U postgres < backup.dump

# Перезагрузить сервис
docker-compose up -d
```

## Администрирование

### Q: Как обновить Supabase?

**A**: 
```bash
cd /opt/supabase/docker
docker-compose pull
docker-compose up -d
# Проверьте логи
docker-compose logs -f
```

### Q: Как обновить n8n?

**A**: 
```bash
cd /opt/n8n
docker-compose pull n8n
docker-compose up -d n8n
# Проверьте логи
docker-compose logs -f n8n
```

### Q: Как перезагрузить сервис?

**A**: 
```bash
# Перезагрузить конкретный сервис
docker-compose restart n8n

# Перезагрузить все
docker-compose down
docker-compose up -d

# Проверить статус
docker-compose ps
```

### Q: Как посмотреть логи?

**A**: 
```bash
# Логи конкретного сервиса
docker-compose logs n8n

# Последние 100 строк
docker-compose logs --tail=100 n8n

# В реальном времени
docker-compose logs -f n8n

# Все логи за последний час
docker-compose logs --since 1h
```

## Поддержка и помощь

### Q: Где найти дополнительную информацию?

**A**: 
- Документация проекта: `/docs` папка
- [n8n документация](https://docs.n8n.io/)
- [Supabase документация](https://supabase.com/docs)
- [PostgreSQL документация](https://www.postgresql.org/docs/)

### Q: Как получить помощь если что-то не работает?

**A**: 
1. Проверьте документацию в `/docs`
2. Запустите `/opt/monitor.sh` для диагностики
3. Посмотрите логи: `docker-compose logs`
4. Создайте issue в репозитории с описанием проблемы
5. Предоставьте логи и конфигурацию (без паролей!)

### Q: Как сообщить об ошибке?

**A**: 
1. Включите максимальный уровень логирования (`LOG_LEVEL=debug`)
2. Воспроизведите ошибку и сохраните логи
3. Создайте issue с:
   - Описанием проблемы
   - Шагами для воспроизведения
   - Логами (без чувствительных данных)
   - Конфигурацией сервера
   - Версиями ПО

## Лучшие практики

### Q: Как лучше структурировать данные в Supabase?

**A**: 
1. Используйте правильные типы данных (не все TEXT)
2. Используйте constraints (NOT NULL, UNIQUE, CHECK)
3. Используйте форейн ключи для связей
4. Нормализуйте данные (избегайте дублирования)
5. Используйте индексы на часто используемые столбцы

### Q: Как лучше организовать workflows в n8n?

**A**: 
1. Один workflow = одна функция
2. Используйте Sub-workflows для переиспользования логики
3. Используйте комментарии и описания
4. Версионируйте workflows (сохраняйте в Git)
5. Тестируйте перед активацией

### Q: Как мониторить систему?

**A**: 
1. Используйте `/opt/monitor.sh` для проверки состояния
2. Добавьте в crontab для регулярных проверок
3. Настройте алерты при ошибках
4. Используйте ELK или Prometheus для мониторинга
5. Регулярно проверяйте использование ресурсов

## Контакты

Если вы не нашли ответ на свой вопрос:
- Создайте issue в репозитории
- Свяжитесь с командой поддержки
- Посетите community форумы n8n и Supabase
